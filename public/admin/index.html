<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Content Manager</title>
  <link rel="stylesheet" href="/admin/admin.css" />
</head>
<body>
  <script>
    (function loadCMS() {
      function log(msg) { try { console.log('[CMS]', msg) } catch (e) {} }
      function load(src, next) {
        var s = document.createElement('script');
        s.src = src; s.async = true;
        s.onload = function () { log('loaded ' + src); next && next(false) };
        s.onerror = function () { log('failed ' + src); next && next(true) };
        document.body.appendChild(s);
      }
      function boot() {
        var ok = !!(window.CMS || window.NetlifyCmsApp);
        if (!ok) log('CMS global missing after load');
      }
      // Primary: official CDN bundle for Netlify CMS
      load('https://unpkg.com/netlify-cms@2.15.72/dist/netlify-cms.js', function (err) {
        if (err) {
          // Fallback: Decap CMS (community continuation)
          load('https://unpkg.com/decap-cms@2.15.0/dist/decap-cms.js', boot);
        } else {
          boot();
        }
      });
      setTimeout(function () {
        if (!(window.CMS || window.NetlifyCmsApp)) {
          var warn = document.createElement('div');
          warn.style.cssText = 'position:fixed;inset:0;display:flex;align-items:center;justify-content:center;font:16px/1.4 system-ui,Segoe UI,Roboto,sans-serif;color:#fff;background:#b00020;z-index:9999;text-align:center;padding:16px';
          warn.textContent = 'CMS failed to load (CDN/CSP). Try reloading or check network.';
          document.body.appendChild(warn);
        }
      }, 4000);
    })();
  </script>
  <script src="/admin/preview.js"></script>
</body>
</html>
